<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="722px" preserveAspectRatio="none" style="width:716px;height:722px;" version="1.1" viewBox="0 0 716 722" width="716px" zoomAndPan="magnify"><defs><filter height="300%" id="f4wuvsar7d7s2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="95" y1="38.4883" y2="381.9043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="95" x2="95" y1="381.9043" y2="409.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="95" y1="409.9043" y2="643.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="95" x2="95" y1="643.3887" y2="671.3887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="95" y1="671.3887" y2="710.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275" x2="275" y1="38.4883" y2="381.9043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="275" x2="275" y1="381.9043" y2="409.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275" x2="275" y1="409.9043" y2="643.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="275" x2="275" y1="643.3887" y2="671.3887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275" x2="275" y1="671.3887" y2="710.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="452" x2="452" y1="38.4883" y2="381.9043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="452" x2="452" y1="381.9043" y2="409.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="452" x2="452" y1="409.9043" y2="643.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="452" x2="452" y1="643.3887" y2="671.3887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="452" x2="452" y1="671.3887" y2="710.6992"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="622" x2="622" y1="38.4883" y2="381.9043"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="622" x2="622" y1="381.9043" y2="409.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="622" x2="622" y1="409.9043" y2="643.3887"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="622" x2="622" y1="643.3887" y2="671.3887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="622" x2="622" y1="671.3887" y2="710.6992"/><rect fill="#FEFECE" filter="url(#f4wuvsar7d7s2)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="15" y="23.5352">OneAlert_NotifySender</text><rect fill="#FEFECE" filter="url(#f4wuvsar7d7s2)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="192" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="199" y="23.5352">推送服务商S1_配额100</text><rect fill="#FEFECE" filter="url(#f4wuvsar7d7s2)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="369" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="149" x="376" y="23.5352">推送服务商S2_配额150</text><rect fill="#FEFECE" filter="url(#f4wuvsar7d7s2)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="546" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="553" y="23.5352">推送服务商Sn_配额m</text><polygon fill="#A80036" points="263.5,65.7988,273.5,69.7988,263.5,73.7988,267.5,69.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="269.5" y1="69.7988" y2="69.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="102" y="65.0566">发送消息1</text><polygon fill="#A80036" points="106,95.1094,96,99.1094,106,103.1094,102,99.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="100" x2="274.5" y1="99.1094" y2="99.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="112" y="94.3672">返回成功1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="137" y1="128.4199" y2="128.4199"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="137" y1="128.4199" y2="141.4199"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="137" y1="141.4199" y2="141.4199"/><polygon fill="#A80036" points="106,137.4199,96,141.4199,106,145.4199,102,141.4199" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102" y="123.6777">记录发送状态</text><polygon fill="#A80036" points="263.5,182.041,273.5,186.041,263.5,190.041,267.5,186.041" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="269.5" y1="186.041" y2="186.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="102" y="165.9883">取出状态，比对S1配额</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="102" y="181.2988">不超，则发送消息2</text><polygon fill="#A80036" points="106,211.3516,96,215.3516,106,219.3516,102,215.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="100" x2="274.5" y1="215.3516" y2="215.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="112" y="210.6094">返回成功2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="137" y1="244.6621" y2="244.6621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="137" y1="244.6621" y2="257.6621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="137" y1="257.6621" y2="257.6621"/><polygon fill="#A80036" points="106,253.6621,96,257.6621,106,261.6621,102,257.6621" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102" y="239.9199">记录发送状态</text><polygon fill="#A80036" points="263.5,298.2832,273.5,302.2832,263.5,306.2832,267.5,302.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="269.5" y1="302.2832" y2="302.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="102" y="282.2305">取出状态，比对S1配额</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="102" y="297.541">不超，发送消息3</text><polygon fill="#A80036" points="106,327.5938,96,331.5938,106,335.5938,102,331.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="100" x2="274.5" y1="331.5938" y2="331.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="112" y="326.8516">返回成功3</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="137" y1="360.9043" y2="360.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="137" y1="360.9043" y2="373.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="137" y1="373.9043" y2="373.9043"/><polygon fill="#A80036" points="106,369.9043,96,373.9043,106,377.9043,102,373.9043" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102" y="356.1621">记录发送状态</text><polygon fill="#A80036" points="263.5,442.5254,273.5,446.5254,263.5,450.5254,267.5,446.5254" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="269.5" y1="446.5254" y2="446.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="102" y="426.4727">取出状态，比对S1配额</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="102" y="441.7832">不超，发送消息n</text><polygon fill="#A80036" points="106,471.8359,96,475.8359,106,479.8359,102,475.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="100" x2="274.5" y1="475.8359" y2="475.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="112" y="471.0938">返回成功n</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="137" y1="505.1465" y2="505.1465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="137" x2="137" y1="505.1465" y2="518.1465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="96" x2="137" y1="518.1465" y2="518.1465"/><polygon fill="#A80036" points="106,514.1465,96,518.1465,106,522.1465,102,518.1465" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="102" y="500.4043">记录发送状态</text><rect fill="#EEEEEE" filter="url(#f4wuvsar7d7s2)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="701" x="3" y="546.8018"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="704" y1="546.8018" y2="546.8018"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="704" y1="549.8018" y2="549.8018"/><rect fill="#EEEEEE" filter="url(#f4wuvsar7d7s2)" height="23.3105" style="stroke: #000000; stroke-width: 2.0;" width="313" x="197" y="536.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="295" x="203" y="552.7148">以上已经耗光了服务商1的配额，该切换新服务商了</text><polygon fill="#A80036" points="440.5,602.0781,450.5,606.0781,440.5,610.0781,444.5,606.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="446.5" y1="606.0781" y2="606.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="102" y="586.0254">取出状态，比对S1配额</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="102" y="601.3359">超了，切换服务商2，发送消息n+1</text><polygon fill="#A80036" points="106,631.3887,96,635.3887,106,639.3887,102,635.3887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="100" x2="451.5" y1="635.3887" y2="635.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="112" y="630.6465">返回成功n</text><polygon fill="#A80036" points="610.5,688.6992,620.5,692.6992,610.5,696.6992,614.5,692.6992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="95" x2="616.5" y1="692.6992" y2="692.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="102" y="687.957">取出状态，比对Sn配额，不超，发送；超出，切换</text><!--
@startuml


hide footbox

OneAlert_NotifySender -> 推送服务商S1_配额100: 发送消息1
OneAlert_NotifySender <- 推送服务商S1_配额100: 返回成功1
OneAlert_NotifySender -> OneAlert_NotifySender : 记录发送状态

OneAlert_NotifySender -> 推送服务商S1_配额100: 取出状态，比对S1配额\n不超，则发送消息2
OneAlert_NotifySender <- 推送服务商S1_配额100: 返回成功2
OneAlert_NotifySender -> OneAlert_NotifySender : 记录发送状态

OneAlert_NotifySender -> 推送服务商S1_配额100: 取出状态，比对S1配额\n不超，发送消息3
OneAlert_NotifySender <- 推送服务商S1_配额100: 返回成功3
OneAlert_NotifySender -> OneAlert_NotifySender : 记录发送状态

...

OneAlert_NotifySender -> 推送服务商S1_配额100: 取出状态，比对S1配额\n不超，发送消息n
OneAlert_NotifySender <- 推送服务商S1_配额100: 返回成功n
OneAlert_NotifySender -> OneAlert_NotifySender : 记录发送状态

== 以上已经耗光了服务商1的配额，该切换新服务商了 ==
OneAlert_NotifySender -> 推送服务商S2_配额150: 取出状态，比对S1配额\n超了，切换服务商2，发送消息n+1
OneAlert_NotifySender <- 推送服务商S2_配额150: 返回成功n

...

OneAlert_NotifySender -> 推送服务商Sn_配额m: 取出状态，比对Sn配额，不超，发送；超出，切换
@enduml

PlantUML version 1.2019.06(Sat May 25 01:10:25 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_181-b13
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>